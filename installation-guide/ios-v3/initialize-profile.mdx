---
title: "Initialize Customer Profile"
description: "Register and identify customers in your iOS app"
---

# Initialize Customer (Register/Identify)

Register a customer whenever they log in or register in your app. This allows Gameball to attach events and rewards to the customer profile.

<CodeGroup>
```swift Swift
import Gameball

// Create customer attributes
let attributes = CustomerAttributes(
    displayName: "John Doe",
    firstName: "John",
    lastName: "Doe",
    email: "john@example.com",
    mobile: "+1234567890",
    gender: "M",
    dateOfBirth: "1990-01-15",
    joinDate: "2024-01-01",
    preferredLanguage: "en"
)

// Add custom attributes
attributes.customAttributes = [
    "loyaltyTier": "gold",
    "city": "New York"
]

// Create customer request
let request = InitializeCustomerRequest(
    customerId: "customer-123",
    email: "john@example.com",
    mobile: "+1234567890",
    customerAttributes: attributes,
    referralCode: "REF123",  // Optional
    isGuest: false           // Optional
)

// Initialize customer
Gameball.shared.initializeCustomer(with: request) { result in
    switch result {
    case .success(let response):
        print("Customer initialized: \(response.gameballId)")
    case .failure(let error):
        print("Error: \(error.localizedDescription)")
    }
}
```

```swift Swift (Async/Await)
import Gameball

Task {
    do {
        let attributes = CustomerAttributes(
            displayName: "John Doe",
            email: "john@example.com",
            mobile: "+1234567890"
        )
        
        let request = InitializeCustomerRequest(
            customerId: "customer-123",
            customerAttributes: attributes
        )
        
        let response = try await Gameball.shared.initializeCustomer(with: request)
        print("Customer initialized: \(response.gameballId)")
    } catch {
        print("Error: \(error.localizedDescription)")
    }
}
```
</CodeGroup>

## Request Parameters

<ParamField body="customerId" type="String" required>
Unique identifier for the customer. This should never change for a given customer.
</ParamField>

<ParamField body="email" type="String">
Customer's email address.
</ParamField>

<ParamField body="mobile" type="String">
Customer's mobile number with country code.
</ParamField>

<ParamField body="deviceToken" type="String">
Push notification token (APNs device token).
</ParamField>

<ParamField body="pushProvider" type="PushProvider">
Push notification provider (`.firebase` or `.apns`).
</ParamField>

<ParamField body="customerAttributes" type="CustomerAttributes">
Additional customer attributes (name, DOB, custom fields, etc.).
</ParamField>

<ParamField body="referralCode" type="String">
Referral code if customer was referred by another customer.
</ParamField>

<ParamField body="isGuest" type="Bool">
Guest user flag (defaults to false).
</ParamField>

### Validation Rules

**InitializeCustomerRequest requires:**
- Customer ID cannot be empty
- If push provider is set, device token is required
- If device token is set, push provider is required

## Customer Attributes

You can enrich customer profiles with additional attributes:

<Expandable title="CustomerAttributes Properties">
  <ParamField body="displayName" type="String">
  Customer's display name.
  </ParamField>
  
  <ParamField body="firstName" type="String">
  Customer's first name.
  </ParamField>
  
  <ParamField body="lastName" type="String">
  Customer's last name.
  </ParamField>
  
  <ParamField body="email" type="String">
  Customer's email address.
  </ParamField>
  
  <ParamField body="mobile" type="String">
  Customer's mobile number.
  </ParamField>
  
  <ParamField body="gender" type="String">
  Gender: "M" for male, "F" for female.
  </ParamField>
  
  <ParamField body="dateOfBirth" type="String">
  Date of birth in `YYYY-MM-DD` format.
  </ParamField>
  
  <ParamField body="joinDate" type="String">
  Join date in `YYYY-MM-DD` format.
  </ParamField>
  
  <ParamField body="preferredLanguage" type="String">
  Preferred language code.
  </ParamField>
  
  <ParamField body="customAttributes" type="[String: String]">
  Custom key-value pairs for additional customer data.
  </ParamField>
  
  <ParamField body="additionalAttributes" type="[String: String]">
  Additional key-value pairs for metadata.
  </ParamField>
</Expandable>

## Advanced Examples

### With Push Notifications

```swift
import Gameball
import UserNotifications

// Request push notification permission
UNUserNotificationCenter.current().requestAuthorization(options: [.alert, .sound, .badge]) { granted, error in
    if granted {
        DispatchQueue.main.async {
            UIApplication.shared.registerForRemoteNotifications()
        }
    }
}

// In AppDelegate
func application(
    _ application: UIApplication,
    didRegisterForRemoteNotificationsWithDeviceToken deviceToken: Data
) {
    let token = deviceToken.map { String(format: "%02.2hhx", $0) }.joined()
    
    let request = InitializeCustomerRequest(
        customerId: "customer-123",
        deviceToken: token,
        pushProvider: .apns
    )
    
    Gameball.shared.initializeCustomer(with: request) { result in
        // Handle result
    }
}
```

### With Referral Code

```swift
func registerCustomerWithReferral(customerId: String, referralCode: String) {
    let request = InitializeCustomerRequest(
        customerId: customerId,
        referralCode: referralCode
    )
    
    Gameball.shared.initializeCustomer(with: request) { result in
        switch result {
        case .success(let response):
            print("Customer registered with referral: \(response.gameballId)")
        case .failure(let error):
            print("Error: \(error.localizedDescription)")
        }
    }
}
```

### Guest User

```swift
func initializeGuestUser(sessionId: String) {
    let request = InitializeCustomerRequest(
        customerId: "guest_\(sessionId)",
        isGuest: true
    )
    
    Gameball.shared.initializeCustomer(with: request) { result in
        // Handle guest user initialization
    }
}
```

### Full Customer Profile

```swift
func initializeFullProfile() {
    let attributes = CustomerAttributes(
        displayName: "John Doe",
        firstName: "John",
        lastName: "Doe",
        email: "john@example.com",
        mobile: "+1234567890",
        gender: "M",
        dateOfBirth: "1990-01-15",
        joinDate: "2024-01-01",
        preferredLanguage: "en"
    )
    
    attributes.customAttributes = [
        "vip_level": "gold",
        "city": "New York",
        "country": "USA"
    ]
    
    attributes.additionalAttributes = [
        "segment": "premium",
        "source": "ios_app"
    ]
    
    let request = InitializeCustomerRequest(
        customerId: "customer-123",
        email: "john@example.com",
        mobile: "+1234567890",
        customerAttributes: attributes
    )
    
    Gameball.shared.initializeCustomer(with: request) { result in
        switch result {
        case .success(let response):
            print("Profile initialized: \(response)")
        case .failure(let error):
            handleError(error)
        }
    }
}
```

<Warning>
**Choose an Unchangeable Customer ID**

The `customerId` should be a permanent identifier that will NEVER change. Avoid using email or phone number as the customer ID since these can be updated by users.
</Warning>

<Tip>
Call `initializeCustomer` after successful login or registration in your app to ensure the customer profile is up-to-date.
</Tip>

## Next Steps

- [Track Customer Events](/installation-guide/ios-v3/track-events)
- [Show Profile Widget](/installation-guide/ios-v3/show-profile)
- [Track Orders & Cashback](/installation-guide/ios-v3/track-orders)


