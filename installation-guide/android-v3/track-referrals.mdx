---
title: "Track Referrals"
description: "Implement referral tracking using Firebase Dynamic Links"
---

# Track Referrals

Gameball referrals use Firebase Dynamic Links to track when customers invite their friends. Implement referral tracking to reward both the referrer and the referred customer.

## Setup

<Steps>
<Step title="Configure Firebase Dynamic Links">
Set up Firebase Dynamic Links in your Firebase console and configure your app to handle deep links.
</Step>

<Step title="Add Dependency">
Add Firebase Dynamic Links dependency to your `build.gradle`:

```groovy
dependencies {
    implementation 'com.google.firebase:firebase-dynamic-links'
}
```
</Step>

<Step title="Configure in Gameball Dashboard">
Provide your Firebase Dynamic Links configuration in the Gameball dashboard.
</Step>
</Steps>

## Handle Deep Links

Configure your app to receive Firebase Dynamic Links:

<CodeGroup>
```kotlin Kotlin
class MainActivity : AppCompatActivity() {
    
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        
        // Handle dynamic link
        Firebase.dynamicLinks
            .getDynamicLink(intent)
            .addOnSuccessListener { pendingDynamicLinkData ->
                var deepLink: Uri? = null
                if (pendingDynamicLinkData != null) {
                    deepLink = pendingDynamicLinkData.link
                }
                
                // Extract referral code from deep link
                val referralCode = deepLink?.getQueryParameter("referralCode")
                
                if (referralCode != null) {
                    // Store referral code to use during registration
                    saveReferralCode(referralCode)
                }
            }
    }
}
```

```java Java
public class MainActivity extends AppCompatActivity {
    
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        
        // Handle dynamic link
        FirebaseDynamicLinks.getInstance()
            .getDynamicLink(getIntent())
            .addOnSuccessListener(this, pendingDynamicLinkData -> {
                Uri deepLink = null;
                if (pendingDynamicLinkData != null) {
                    deepLink = pendingDynamicLinkData.getLink();
                }
                
                // Extract referral code from deep link
                if (deepLink != null) {
                    String referralCode = deepLink.getQueryParameter("referralCode");
                    
                    if (referralCode != null) {
                        // Store referral code to use during registration
                        saveReferralCode(referralCode);
                    }
                }
            });
    }
}
```
</CodeGroup>

## Register Customer with Referral

When initializing the customer, include the referral code if available:

```kotlin
val customerRequest = InitializeCustomerRequest.builder()
    .customerId("customer-123")
    .email("customer@example.com")
    .referralCode(savedReferralCode)  // Include referral code
    .build()

GameballApp.getInstance(context).initializeCustomer(
    customerRequest,
    object : Callback<InitializeCustomerResponse> {
        override fun onSuccess(response: InitializeCustomerResponse) {
            // Customer registered with referral
        }
        
        override fun onError(error: Throwable) {
            // Handle error
        }
    }
)
```

## Get Customer Referral Link

Retrieve the customer's unique referral link to share:

```kotlin
GameballApp.getInstance(context).getCustomerReferralInfo(
    "customer-123",
    object : Callback<ReferralInfo> {
        override fun onSuccess(referralInfo: ReferralInfo) {
            val referralCode = referralInfo.referralCode
            val referralLink = referralInfo.referralLink
            
            // Display link for sharing
            showShareDialog(referralLink)
        }
        
        override fun onError(error: Throwable) {
            // Handle error
        }
    }
)
```

## Share Referral Link

Create a share intent to let customers share their referral link:

```kotlin
fun shareReferralLink(referralLink: String) {
    val shareIntent = Intent().apply {
        action = Intent.ACTION_SEND
        putExtra(Intent.EXTRA_TEXT, "Join me on our app! Use my referral link: $referralLink")
        type = "text/plain"
    }
    
    startActivity(Intent.createChooser(shareIntent, "Share referral link"))
}
```

## Referral Flow

<Steps>
<Step title="Customer A Gets Referral Link">
Existing customer (referrer) gets their unique referral link from the app.
</Step>

<Step title="Customer A Shares Link">
Customer A shares the link with friends via social media, messaging, etc.
</Step>

<Step title="Customer B Clicks Link">
New customer (referee) clicks the referral link and installs the app.
</Step>

<Step title="App Captures Referral Code">
App captures the referral code from the Firebase Dynamic Link.
</Step>

<Step title="Customer B Registers">
New customer registers with the referral code included.
</Step>

<Step title="Both Customers Rewarded">
Gameball rewards both the referrer and referee based on your program configuration.
</Step>
</Steps>

<Info>
Configure referral rewards and rules in your Gameball dashboard to determine how and when referrers and referees are rewarded.
</Info>

## AndroidManifest Configuration

Add intent filter to handle Firebase Dynamic Links:

```xml
<activity android:name=".MainActivity">
    <intent-filter>
        <action android:name="android.intent.action.VIEW" />
        <category android:name="android.intent.category.DEFAULT" />
        <category android:name="android.intent.category.BROWSABLE" />
        <data
            android:host="yourdomain.page.link"
            android:scheme="https" />
    </intent-filter>
</activity>
```

## Next Steps

- [Go-Live Checklist](/installation-guide/android-v3/go-live-checklist)
- [Migration Notes](/installation-guide/android-v3/migration-notes)

